<!DOCTYPE html>
<html>
<head>
<title>SpreadTable</title>
<link rel="stylesheet" type="text/css" href="static/base.css" />
<script src="static/base.js" type="text/javascript"></script>
<script src="static/jTable.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.1/build/logger/assets/logger.css">
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.5.1/build/yuitest/assets/testlogger.css">
<script type="text/javascript" src="http://yui.yahooapis.com/2.5.1/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.5.1/build/logger/logger-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.5.1/build/yuitest/yuitest-min.js"></script>
</head>
<body>

<div id="menu">
	<h1>SpreadTable</h1>
	<ul id="tabHeaders">
		<li><a href="javascript:menu.clickTab('File')">File</a></li>
		<li class="selected"><a href="javascript:menu.clickTab('Style')">Style</a></li>
		<li><a href="javascript:menu.clickTab('Insert')">Insert</a></li>
		<li><a href="javascript:menu.clickTab('Revise')">Revise</a></li>
		<li><a href="javascript:menu.clickTab('Collaborate')">Collaborate</a></li>
	</ul>
	<div id="tabContents">
		<ul id="tabFile">
			<li>Save</li>
			<li>Cut</li>
			<li>Copy</li>
			<li>Paste</li>
		</ul>
		<ul id="tabStyle" class="selected">
			<li><button onclick="menu.style('bold')" title="bold" style="font-weight:bold">B</button></li>
			<li><button onclick="menu.style('italic')" title="italic" style="font-style:italic">I</button></li>
			<li><button onclick="menu.style('underline')" title="underline" style="text-decoration:underline">U</button></li>
			<li><button onclick="menu.style('fontName', 'Arial')" title="font" style="font-family:Comica Sans, Arial">F</button></li>
			<li><button onclick="menu.style('fontSize', 5)" title="font size" style="font-size:x-small">TT</button></li>
			<li><button onclick="menu.style('foreColor', 'red')" title="font color" style="color:red">F</button></li>
			<li><button onclick="menu.style('hiliteColor', 'red')" title="highlight" style="background-color:yellow">H</button></li>
			<li><button onclick="menu.style('justifyLeft')" title="align left">&larr</button></li>
			<li><button onclick="menu.style('justifyRight')" title="align right">&rarr</button></li>
			<li><button onclick="menu.style('justifyCenter')" title="justify">&harr</button></li>
			<li><button onclick="" title="border" style="border:1px solid red">B</button></li>
			<li><button onclick="menu.style('backColor', 'yellow')" title="background" style="background-color:yellow">B</button></li>
		</ul>
		<ul id="tabInsert">
			<li>Image</li>
			<li>Hyperlink</li>
			<li>Table</li>
			<li>Function</li>
		</ul>
		<ul id="tabRevise">
			<li>Revise</li>
		</ul>
		<ul id="tabCollaborate">
			<li>Collaborate</li>
		</ul>
	</div>
</div>

<table id="firstTable" style="display:none">
	<tr id="firstTableRow"><th id="firstTableCell"></th></tr>
</table>

<div id="divContent" onmousedown="mDown(event)">
	<table id="testTable" viewas="table">
	  <caption>Joe Blogs Sales (2006)</caption>
	  <thead>
	    <tr>
	      <th>Country</th>
	      <th id="testColHeader">Q1</th>
	      <th id="testColHeader2">Q2</th>
	      <th>Q3</th>
	      <th>Q4</th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr>
	      <th>USA</th>
	      <td>100</td>
	      <td>80</td>
	      <td>110</td>
	      <td>150</td>
	    </tr>
	    <tr>
	      <th>UK</th>
	      <td>50</td>
	      <td>70</td>
	      <td>120</td>
	      <td>130</td>
	    </tr>
	    <tr>
	      <th>France</th>
	      <td>60</td>
	      <td>80</td>
	      <td>90</td>
	      <td>90</td>
	    </tr>
	  </tbody>
	</table>
</div>

<div id="colOptions" class="tableOptions">
	<h3>Heading</h3>
	<div id="colOptionsSort">
		<h4>Sort:</h4>
	  	<span class="divOption">
			<input type="radio" name="sort" id="sort_ascending" value="ascending"/>
			<label for="sort_ascending">ascending</label>
	  	</span>
	  	<span class="divOption">
			<input type="radio" name="sort" id="sort_descending" value="descending"/>
			<label for="sort_descending">descending</label>
	  	</span>
    </div>
    <div id="colOptionsFilter">
    	<h4>Filter:</h4>
    	<a href="javascript:objColOptions.chkAllNone(true)">all</a> <a href="javascript:objColOptions.chkAllNone(false)">none</a>
    </div>
	<div id="colOptionsHide">
		<h4>Hide:</h4>
		<span class="divOption">
			<input type="checkbox" id="chkHide" value="hide">
			<label for="chkHide">Hide column</label>
	  	</span>
	</div>
	<div id="colOptionsOKCancel">
	  	<input type="button" id="ColOptionsOK" value="OK" onclick="objColOptions.submit()"/>
	  	<input type="button" id="ColOptionsCancel" value="Cancel" onclick="objColOptions.close()">
    </div>
</div>
<div id="tableTransform" class="tableOptions">
	<h3>Table Transform</h3>
	<div id="tableTransformUnhide">
		<h4>Unhide:</h4>
	  	<span class="divOption">
			<input type="checkbox" id="unhide_test" disabled>
			<label for="unhide_test">No columns hidden</label>
	  	</span>
    </div>
    <div id="tableTransformDisplayAs">
    	<h4>Display as:</h4>
		<span class="divOption">
			<input type="radio" name="display_as" id="display_as_table" value="table" checked=""/>
			<label for="display_as_table">Table</label>
		</span>
		<span class="divOption">
			<input type="radio" name="display_as" id="display_as_barchart" value="bar chart"/>
			<label for="display_as_barchart">Bar Chart</label>
		</span>
	</div>
	<div id="tableTransformPivot">
		<h4>Pivot:</h4>
	</div>
	<div id="tableTransformOKCancel">
	  	<input type="button" id="TableOptionsOK" value="OK" onclick="tableTransform.submit()"/>
	  	<input type="button" id="TableOptionsCancel" value="Cancel" onclick="tableTransform.close()">
    </div>
</div>

<script>
/*
* Object Model
*
* jTable() is the top level object / namespace.
* jTable.t() represents a table object
*	jTable.t(DOM object) returns a jTable.t() object using the relevant DOM object
* 		DOM Object can be the table itself or any element within it
* 	jTable.t().getSort() returns an array of objects of the form {cellIndex: n, dir: "dir"}
*		the array represents the current sort on the table, ordered as per the array
* 	jTable.t().setSort([{obj}]) sorts the table and returns the new sort array
* 		{obj} is of the form {cellIndex: 2, sort: "up"}.
*		you can pass an array of {obj}s, in which case the sorts are done in array order
*	jTable.t().getHide() returns an array of all cellIndexes that are currently hidden
*	jTable.t().setHide([]) hides / unhides certain columns using the array, and returns the array
*		the array has one entry per hidden cellIndex. Any missing cellIndexes are unhidden.
*	jTable.t().getFilter() returns an array of objects of the form {cellIndex: n, filterIn: []}
* 	jTable.t().setFilter([{obj}]) sets filters on a number of columns
*		every array item represents the filter on a particular column
*	jTable.t().dataType() returns an array representing the data type of each cellIndex
* jTable.$() is the getDocumentById function as per prototype and jQuery
* jTable.h() represents a table header cell
*	jTable.h(DOM object) returns a jTable.t() object using the relevant DOM object
* 		DOM Object can be the table itself or any element within it
* 		DOM Object can also be an array of DOM objects, in which case t() returns an array of results
* 	jTable.h().getSort() returns either "", "up" or "down" depending on the sort on that column
* 	jTable.h().setSort(dir) sorts the column, wipes other column sorts and returns dir
*	jTable.h().getHide() returns true if the column is hidden, otherwise it returns false
*	jTable.h().setHide(true|fasle) hides / unhides the column
*	jTable.h().getFilter() returns an objects of the form {cellIndex: n, filterIn: []}
* 	jTable.h().setFilter({obj}) sets filters on the column
*		the cellIndex property is not required and automatically calculated if missing.
*	jtable.h().dataType() returns the calculated data type of the column
*/
</script>
<script src="static/jTableTest.js"></script>
</body>
</html>